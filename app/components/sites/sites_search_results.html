<h3>Sites - recherche avanc&eacute;e - <span class="text-primary">r&eacute;sultats</span></h3>
<br />
<div class="row">
    <div class="col-md-8 col-md-offset-2">
        <div class="panel panel-primary">
            <div class="panel-heading">Param&egrave;tres de recherche</div>
            <div class="panel-body">
                <div class="row" ng-if="filter.dept">
                    <div class="col-xs-4 text-right">D&eacute;partement</div>
                    <div class="col-xs-8"><strong>{{departments[filter.dept].dept_name}}</strong></div>
                </div>
                <div class="row" ng-if="filter.nb.o" ng-init="option = (comparisonOptions | filter: {value: filter.nb.o})[0]">
                    <div class="col-xs-4 text-right">Nombre d'agents</div>
                    <div class="col-xs-8">{{option.display}} <span class="text-primary">{{filter.nb.d}}</span></div>
                </div>
                <div class="row" ng-if="filter.perm.o" ng-init="option = (comparisonOptions | filter: {value: filter.perm.o})[0]">
                    <div class="col-xs-4 text-right">Nombre de CDI</div>
                    <div class="col-xs-8">{{option.display}} <span class="text-primary">{{filter.perm.d}}</span></div>
                </div>
                <hr ng-if="certificates.length > 0 && hasFiltersBesidesCert()" />
                <div ng-repeat="cert in certificates">
                    <div class="row" ng-repeat="condition in cert.conditions" ng-init="params = condition.params">
                        <div class="col-xs-4 text-right">{{$first && $parent.$first ? 'Aptitudes' : ''}}</div>
                        <div class="col-xs-8">
                            <hr ng-if="!$parent.$first && $first" />
                            <div ng-switch="params.condition.value">
                                <div ng-switch-when="number">Agents <span class="text-primary">{{cert.cert_short}}</span> {{params.option.short}} <span class="text-primary">{{params.data}}</span></div>
                                <div ng-switch-when="percent">Taux <span class="text-primary">{{cert.cert_short}}</span> {{params.option.short}} <span class="text-primary">{{params.data}}%</span></div>
                                <div ng-switch-when="target">Cible <span class="text-primary">{{cert.cert_short}}</span>
                                    <span class="text-{{params.option.value}}">{{params.option.display | lowercase}}</span>
                                    <span class="text-primary">{{params.data}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-12">
        <div class="panel panel-primary">
            <div class="panel-heading">R&eacute;sultats</div>
            <busy busy-task="sitesSearchResults">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-xs-4 text-right">Nombre de sites</div>
                        <div class="col-xs-8"><strong>{{sites.length}}</strong> site(s) correspondant aux crit&egrave;res</div>
                    </div>
                </div>
                <table class="table table-striped table-hover" st-table="shown" st-safe-src="sites" st-set-sort="orderByNullLast">
                    <thead>
                        <tr>
                            <th width="53px"></th>
                            <th ng-repeat="header in theaders" ng-bind-html="header.display" class="st-sort" st-sort="{{header.path}}" st-skip-natural="true"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="site in shown" ng-if="$index < 100" ng-click="select(site.site_pk);" class="clickme" ng-mouseenter="hover=true" ng-mouseleave="hover=false" ng-class="{'text-primary': hover}">
                            <td>
                                <button type="button" class="btn btn-primary btn-xs" ng-disabled="!hover">VOIR</button>
                            </td>
                            <td ng-repeat="header in theaders">{{get(site, header.path)}}</td>
                        </tr>
                        <tr ng-if="shown.length > 100">
                            <td colspan="{{theaders.length + 1}}" class="text-center">{{shown.length - 100}} sites suppl&eacute;mentaires...</td>
                        </tr>
                    </tbody>
                </table>
            </busy>
        </div>
    </div>
</div>
<div class="side-panel-container text-right">
    <button type="button" class="btn btn-raised btn-success side-panel-item" ng-click="getLink()"><span class="glyphicon glyphicon-link"></span>&nbsp;Sauver/partager recherche</button>
    <button type="button" class="btn btn-raised btn-primary side-panel-item" ng-click="params()"><span class="glyphicon glyphicon-wrench"></span>&nbsp;Modifier param&egrave;tres</button>
</div>
